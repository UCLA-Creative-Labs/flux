(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{178:function(e,t,n){},179:function(e,t,n){},180:function(e,t,n){},189:function(e,t,n){},190:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(86),i=n.n(s),o=(n(96),n(8)),u=n(9),c=n(11),l=n(10),d=n(12),f=n(26),p=n(25),m=n(63),h=n(3),v=n.n(h),b=n(87),E=function(e,t,n,a){var r=v.a.database().ref("posts"),s={userId:e,text:t,likes:0,timestamp:new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).format(a)};return null!==n&&(s.photo=n),r.push(s)},I=function(e){v.a.database().ref("posts").on("value",function(t){e(t.val())})},g={initialize:function(){0===v.a.apps.length&&v.a.initializeApp(b.firebaseConfig)},listenForAuthStateChange:function(e,t){v.a.auth().onAuthStateChanged(function(n){n?(function(e){v.a.database().ref("users/".concat(e.uid)).update({profilePicture:e.photoURL})}(n),e(n)):t()})},logout:function(){v.a.auth().signOut()},sendMessage:function(e,t){v.a.database().ref("/conversations/".concat(e,"/messages/")).push(t)},listenForMessages:function(e,t,n){null!==e&&void 0!==e&&e.off();var a=v.a.database().ref("/conversations/".concat(t,"/messages/"));a.on("value",function(e){n(e.val(),a)})},sendPost:function(e,t,n,a){var r=Date.now();if(null!==n){var s=v.a.storage().ref().child("users/".concat(e).concat(r,".jpg"));s.put(n).then(function(){s.getDownloadURL().then(function(n){E(e,t,n,r).then(a)})})}else E(e,t,n,r).then(a)},listenForPosts:I,incrementLike:function(e,t,n){var a=v.a.database().ref("posts"),r=v.a.database().ref("users").child(n).child("/likedPosts"),s=!1;r.once("value",function(n){n.forEach(function(e){e.val()===t&&(s=!0)}),!1===s&&(r.push(t),a.child(t).update({likes:e+1}))})},listenForFriends:function(e,t){var n=v.a.database().ref("users/".concat(e,"/friends/"));n.on("value",function(e){var a=e.val();null===a&&(a={}),t(a,n)})},addFriend:function(e,t){var n=v.a.database().ref("/users/".concat(e,"/friends")),a=v.a.database().ref("/users/".concat(t,"/friends"));!function(e,t){var n=v.a.database().ref("conversations").push(),a={text:"Test Initial message",userId:e};n.child("messages").push(a).then(t(n.key))}(e,function(r){var s=Object(m.a)({},t,r),i=Object(m.a)({},e,r);n.update(s),a.update(i)})},listenForUserPosts:function(e,t){I(function(n){var a=Object.keys(n).filter(function(t){return n[t].userId===e}),r={};a.forEach(function(e){r[e]=n[e]}),t(r)})},listenForLikedPosts:function(e,t){v.a.database().ref("users/".concat(e,"/likedPosts/")).on("value",function(e){var n=e.val();null===n&&(n={});var a=Object.values(n);I(function(e){var n={};a.forEach(function(t){n[t]=e[t]}),t(n)})})},getProfilePicture:function(e,t){v.a.database().ref("users/".concat(e,"/profilePicture")).once("value",function(e){t(e.val())})}},k=n(34),y=n.n(k),O=n(64),j=n.n(O),C=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e={signInSuccessUrl:"/",signInOptions:[y.a.auth.GoogleAuthProvider.PROVIDER_ID,y.a.auth.FacebookAuthProvider.PROVIDER_ID,y.a.auth.EmailAuthProvider.PROVIDER_ID]};(j.a.auth.AuthUI.getInstance()||new j.a.auth.AuthUI(y.a.auth())).start("#firebaseui-auth-container",e)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Login Page"),r.a.createElement("div",{id:"firebaseui-auth-container"}))}}]),t}(a.Component),P=(n(178),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).textInputHandler=function(e){n.setState({text:e.target.value})},n.fileUploadHandler=function(){var e=document.getElementById("fileItem").files[0];n.setState({photo:e})},n.postSubmitHandler=function(e){var t=n.props.userId,a=n.state,r=a.photo,s=a.text;e.preventDefault(),g.sendPost(t,s,r,function(){n.setState({text:"",photo:null})})},n.state={text:"",photo:null},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.text;return r.a.createElement("div",{className:"MakePost"},r.a.createElement("h1",null,"Make a Post"),r.a.createElement("textarea",{className:"post",type:"text",value:e,placeholder:"Type something...",onChange:this.textInputHandler}),r.a.createElement("input",{id:"fileItem",type:"file",accept:"image/*",onChange:this.fileUploadHandler}),r.a.createElement("button",{type:"submit",onClick:this.postSubmitHandler},"Post"))}}]),t}(r.a.Component)),x=(n(179),function(e){var t=e.postId,n=e.postObject,a=e.userId;return r.a.createElement("div",{className:"post"},r.a.createElement("p",null,"post: ",t),r.a.createElement("p",null,"user_id: ",n.userId),r.a.createElement("p",null,"timestamp: ",n.timestamp),r.a.createElement("p",null,"text: ",n.text),r.a.createElement("p",null,r.a.createElement("img",{className:"photo",src:n.photo,alt:""})),r.a.createElement("p",null,"likes: ",n.likes),r.a.createElement("button",{type:"submit",onClick:function(){g.incrementLike(n.likes,t,a)}},"Like!"))}),F=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).state={posts:{}},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;"home"===this.props.type&&g.listenForPosts(function(t){e.setState({posts:t})})}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.type,a=e.profileId,r=function(e){t.setState({posts:e})};"user"===n?g.listenForUserPosts(a,r):"liked"===n&&g.listenForLikedPosts(a,r)}},{key:"render",value:function(){var e=this.state.posts,t=this.props,n=t.userId,a=t.type;return r.a.createElement("div",null,"home"===a&&r.a.createElement(P,{userId:n}),Object.keys(e).reverse().map(function(t){return r.a.createElement(x,{key:t,postId:t,postObject:e[t],userId:n})}))}}]),t}(a.Component);F.defaultProps={profileId:""};var S=F,w={sent:{width:"40%",backgroundColor:"blue"},received:{width:"40%",backgroundColor:"white"}};var R=function(e){var t=e.text,n=e.sent?w.sent:w.received;return r.a.createElement("div",{style:n},t)},D=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).handleChange=function(e){n.setState({text:e.target.value})},n.handleClick=function(e){e.preventDefault();var t=n.state.text,a=n.props,r=a.userId,s=a.conversationId,i={text:t,userId:r};g.sendMessage(s,i),n.setState({text:""})},n.state={messages:[],text:""},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.conversationId,n=this.state.prevConversationRef;g.listenForMessages(n,t,function(t,n){e.setState({messages:t,prevConversationRef:n})})}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.conversationId,a=this.state.prevConversationRef;g.listenForMessages(a,n,function(e,n){t.setState({messages:e,prevConversationRef:n})})}},{key:"render",value:function(){var e=this.state,t=e.text,n=e.messages,a=this.props,s=a.userId,i=a.conversationId;return r.a.createElement("div",null,r.a.createElement("h1",null,"Temporary Messaging Window"),r.a.createElement("h1",null,i),Object.keys(n).map(function(e){return n[e].userId===s?r.a.createElement(R,{key:e,text:n[e].text,sent:!0}):r.a.createElement(R,{key:e,text:n[e].text,sent:!1})}),r.a.createElement("form",null,r.a.createElement("input",{type:"text",onChange:this.handleChange,value:t}),r.a.createElement("button",{onClick:this.handleClick,type:"submit"},"Send!")))}}]),t}(a.Component),L=(n(180),function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).handleFriendClick=function(e){n.setState({activeConversation:e})},n.state={friends:{},activeConversation:null},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.userId;if(void 0===this.state.friendsRef){g.listenForFriends(t,function(t,n){e.setState({friends:t,friendsRef:n})})}}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.userId;if(void 0===this.state.friendsRef){g.listenForFriends(n,function(e,n){t.setState({friends:e,friendsRef:n})})}}},{key:"render",value:function(){var e=this,t=this.state,n=t.friends,a=t.activeConversation,s=this.props.userId;return r.a.createElement("div",null,Object.keys(n).map(function(t){return r.a.createElement("div",{key:t},r.a.createElement("button",{className:"friend-name",type:"button",onClick:function(){return e.handleFriendClick(t)}},"Friend ",t))}),null!=a?r.a.createElement(D,{userId:s,conversationId:n[a]}):r.a.createElement("p",null," Click a friend to get started! "))}}]),t}(a.Component)),M=function(e){var t=e.friends;return r.a.createElement("div",null,"Friends:",Object.keys(t).map(function(e){return r.a.createElement("p",{key:e},e)}))},U=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(c.a)(this,Object(l.a)(t).call(this,e))).addFriend=function(){var e=n.props,t=e.userId,a=e.match.params.profileId;g.addFriend(t,a)},n.state={friends:{}},n}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.profileId;g.getProfilePicture(t,function(t){e.setState({profilePicture:t})}),g.listenForFriends(t,function(t){e.setState({friends:t})})}},{key:"render",value:function(){var e=this.props,t=e.userId,n=e.handleLogout,a=e.match.params.profileId,s=this.state,i=s.friends,o=s.profilePicture;return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("button",{type:"submit",onClick:n},"Logout")),r.a.createElement("img",{src:o,alt:"Profile"}),r.a.createElement("h1",null,a),a===t||t in i?r.a.createElement("div",null):r.a.createElement("button",{type:"button",onClick:this.addFriend},"Add Friend"),r.a.createElement(M,{friends:i}),r.a.createElement("div",null,r.a.createElement("h2",null,"User Posts"),r.a.createElement(S,{userId:t,profileId:a,type:"user"})),r.a.createElement("div",null,r.a.createElement("h2",null,"Liked Posts"),r.a.createElement(S,{userId:t,profileId:a,type:"liked"})))}}]),t}(a.Component),A=function(e){var t=e.userId;return r.a.createElement("nav",null,r.a.createElement(f.b,{to:"/newsfeed"},"Home"),r.a.createElement(f.b,{to:"/messages"},"Messages"),r.a.createElement(f.b,{to:"/user/".concat(t)},"Profile"))},N=(n(189),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(c.a)(this,Object(l.a)(t).call(this))).handleLogout=function(e){e.preventDefault(),g.logout(),setTimeout(function(){var e=window.location.href.match(/.*\/\/.*?\//)[0];window.location.replace(e)},100)},g.initialize(),e.state={userId:""},e}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;g.listenForAuthStateChange(function(t){e.setState({userId:t.uid})},function(){e.setState({userId:""})})}},{key:"render",value:function(){var e,t=this,n=this.state.userId;return e=""===n?r.a.createElement(f.a,null,r.a.createElement(p.d,null,r.a.createElement(p.b,{exact:!0,path:"/",component:C}))):r.a.createElement(f.a,null,r.a.createElement(A,{userId:n}),r.a.createElement(p.b,{exact:!0,path:"/",render:function(){return r.a.createElement(p.a,{to:"/newsfeed"})}}),r.a.createElement(p.b,{path:"/newsfeed",render:function(){return r.a.createElement(S,{userId:n,type:"home"})}}),r.a.createElement(p.b,{path:"/messages",exact:!0,render:function(){return r.a.createElement(L,{userId:n})}}),r.a.createElement(p.b,{path:"/user/:profileId",render:function(e){return r.a.createElement(U,Object.assign({userId:n,handleLogout:t.handleLogout},e))}})),r.a.createElement("div",{className:"App"},r.a.createElement("p",null,"Your userId is ",n),e)}}]),t}(a.Component));i.a.render(r.a.createElement(N,null),document.getElementById("root"))},87:function(e,t){e.exports={firebaseConfig:{apiKey:"AIzaSyBpvV3UxNK--GI_Q0WFojfrjRPSyqLNt1Q",authDomain:"flux-238200.firebaseapp.com",databaseURL:"https://flux-238200.firebaseio.com",projectId:"flux-238200",storageBucket:"flux-238200.appspot.com",messagingSenderId:"103830355664"}}},91:function(e,t,n){e.exports=n(190)},96:function(e,t,n){}},[[91,1,2]]]);
//# sourceMappingURL=main.7352cdf6.chunk.js.map